<!doctype html>
<html lang="en-US">
<head>
    <meta charset="utf-8">
    <title>Director</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!--[if lt IE 9]>
        <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.2/html5shiv.js"></script>
    <![endif]-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <link rel='stylesheet' type='text/css' href='normalize.css'>
    <link href='https://fonts.googleapis.com/css?family=Roboto:400,500,700,300' rel='stylesheet' type='text/css'> 
</head>
<body>
	<style>
	*,div{box-sizing: border-box;}
  body{font-family:'Roboto', 'Helvetica Neue', Helvetica, Arial, sans-serif; background: #eeeeee; padding: 0 0 0 0; margin: 0 0 0 0;}
	p{line-height: 1em; margin-top:8px; margin-bottom: 8px; font-size: 13px;}
  p.center{text-align: center;}
  #director-main{margin-top: 6%; }
  .wrapper,footer{width: 500px; max-width: 100%; margin: auto;}
  .wrapper{ padding: 20px 28px 30px; border: 1px solid #cccccc; height: 316px;  background: #ffffff;}
	form#director{}
	input[type="text"],input[type="password"]{width: 100%;padding: 8px; margin: 4px auto; font-size: 12px; border: 1px solid #cccccc;}
  .button{padding: 14px 4px; background: #353535; text-transform: uppercase;  margin: 16px 0; min-width: 160px;  border: 0px; border-radius: 100px; -moz-border-radius: 100px; -webkit-border-radius: 100px; transition: all 150ms ease; -webkit-transition: all 150ms ease; -moz-transition: all 150ms ease; cursor: pointer; letter-spacing: 1px; color: #ffffff }
  .button:hover{background: #000000;}
  .disabled{ background: #c7c7c7; color: #4c4c4c;}
  footer{padding: 20px 0px; position: relative;}
  </style>
	<div class="wrapper" id="director-main">
	<h2>Create New OEG Director</h2>
	<form id="director" name="director_new">
	<p>Director Name:</p>
	<input type="text" name="director_name" class="validate" data-name="Director Name" placeholder="Director Name (required)">
	<p>Director Pasword:</p>
	<input type="password" name="director_password" class="validate" data-name="Director Password" placeholder="Director Password (required)">
	<input type="submit" class="button" value="Submit">
	</form>
</div>
<footer>
  <p class="center">&copy 2015 Oil Exploration Game by Olivet Nazarene University</p>
</footer>
	<script>
	$(function() {
    	$('form#director').submit(function (e) {
    		e.preventDefault();
    		if( validate($(this)) ){
    			var new_director = {
    				name: $('form#director input[name="director_name"]').val(),
    				password: $('form#director input[name="director_password"]').val()
          };
          $('form#director input[type="submit"]').addClass("disabled");
				  $.ajax({
					  url: '/new-director',
					  type: 'POST',
					  contentType: 'application/json',
					  data: JSON.stringify(new_director)
				  }).done(function( data ){
					  if(data.token != null || data.token != ""){
              localStorage.setItem("token", data.token);
              var port = window.location.port || 80;
						  window.location.assign('http://' + window.location.hostname + ':' + port + '/director?token=' + data.token);
					  }
				  });
    		}
    	});
		/* Accepts form element, validates all input */
		function validate(form){
			var validated = true;
			form + $(":input").each(function(){
	 				if($(this).prop("type") != "submit"){
	 					if($(this).val() == "" || $(this).val() == " " || $(this).val() == null){
	 						$(this).css("border", "2px solid red");
	 						$(this).css("background-color", "rgba(255, 0, 0, 0.10)");
	 						alert("ERROR: " + $(this).data("name") + " is a required field.");
	 						validated = false;
	 					}
	 					else{
	 						$(this).css("border", "1px solid #cccccc");
	 						$(this).css("background-color", "transparent");
	 					}
	 				}
			});
			return validated;
		}
	});
	</script>
</body>
</html>
